{% extends 'questionic/layout.html' %}
{% block body %}

<div class="row g-0">
    <div class="col-3"></div>
    <div class="col-6">
        <br>
        <p>Questionic > ระดับ: {{question.grade}} > หมวดหมู่: {{question.category}} <p>
        <h1>{{question.title}}<h1>
        <h5>{{question.detail}}<h5>
        <br>
        {%for img in list_images %}
            <img src='{{img.image.url}}' width="100" height="150">
        {%endfor%}
        <br><br><br>
        
        <div style='display: flex;'>
            <img src="{{question.asker.image_profile.url}}" width="50" height="50">
            <h6>&nbsp {{question.asker}} <br>&nbsp {{question.date_asked}}</h6> 

        </div>
        <hr>
        
        <br><br><br><br>
        <h4>แสดงความคิดเห็น<h4>
        <br><br><br><br>
        
        <div style='display: flex;'>
            <img src="{{myaccount.image_profile.url}}" width="50" height="50">
            <h6>&nbsp {{myaccount}}</h6> 
        </div>
        <div style="margin-left: 55px;">
            <form action="{% url 'questionic:question' question.id %}" method="post" enctype="multipart/form-data">
                {% csrf_token %}
                <textarea rows = "5" cols = "50" name = "Detail" placeholder="เขียนความคิดเห็น" required></textarea>
                <input type="file" name="images" accept="image/png, image/jpeg" multiple>
                <button type="submit" name="comment" value="{{question.id}}">ส่งความคิดเห็น</button>
            </form>
        </div>
        <br><br><br>
        <h4>ความคิดเห็น<h4>
        <br>
        {%for answer, image_answer in dict_answer_image.items %}
            <div style='display: flex;'>
                <img src="{{answer.answerer.image_profile.url}}" width="50" height="50">
                <h6>&nbsp&nbsp{{answer.answerer}} &nbsp&nbsp&nbsp {{answer.date_answered}}<h6>
            </div>

            <div style="margin-left: 55px;">
                <h5> {{answer.detail}}<h5>
                
                {%for image in image_answer%}
                    <img src='{{image.image.url}}' width="100" height="150">
                {%endfor%}
            </div>
            
            <br><br>
            {% comment %} <button name="show_reply_button" onclick='show_reply('{{answer.id}}')'>ตอบกลับ</button> {% endcomment %}
            {% comment %} hidden id='show_reply' + '{{answer.id}}' {% endcomment %}
            <div style="margin-left: 75px;">
                <div style='display: flex;'>
                    <img src="{{myaccount.image_profile.url}}" width="50" height="50">
                    <h6>&nbsp {{myaccount}}</h6> 
                </div>
                <div style="margin-left: 55px;">
                    <form action="{% url 'questionic:question' question.id %}" method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <textarea rows = "5" cols = "50" name = "Detail" placeholder="เขียนตอบกลับ" required></textarea>
                        <input type="file" name="images" accept="image/png, image/jpeg" multiple>
                        <button type="submit" name="reply" value="{{answer.id}}">ส่งตอบกลับ</button>
                    </form>
                </div>
            </div>
            <br>
            {%for ans, reply_answer_image in dict_reply_image.items %}
                {%if answer.id is ans.id %}
                    {%for reply, image_reply in reply_answer_image.items %}

                    <div style="margin-left: 75px;">
                        <div style='display: flex;'>
                            <img src="{{reply.reply_answerer.image_profile.url}}" width="50" height="50">
                            <h6>&nbsp&nbsp {{reply.reply_answerer}} &nbsp&nbsp&nbsp {{reply.date_reply_answered}}<h6>
                        </div>
                        
                        <div style="margin-left: 55px;">
                            <h5>{{reply.detail}}<h5>
                            
                                {%for image in image_reply%}
                                <img src='{{image.image.url}}' width="50" height="75">
                            {%endfor%}
                        </div>
                    </div>
                    <br>
                    {%endfor%}
                {%endif%}
            {%endfor%}
        {%endfor%}



    </div>
    <div class="col-3"></div>
</div>


<script>
    function show_reply(id){
        let reply = document.getElementById("show_reply" + id);
        reply.hidden = false;
        console.log(id)
    }
</script>


{% endblock %}